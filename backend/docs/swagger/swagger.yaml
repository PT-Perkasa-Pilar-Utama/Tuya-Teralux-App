basePath: /
definitions:
  dtos.AsyncTranscriptionLongProcessResponseDTO:
    properties:
      status:
        $ref: '#/definitions/dtos.AsyncTranscriptionLongStatusDTO'
      task_id:
        type: string
    type: object
  dtos.AsyncTranscriptionLongResultDTO:
    properties:
      detected_language:
        example: id
        type: string
      text:
        example: Ini adalah transkripsi yang sangat panjang...
        type: string
    type: object
  dtos.AsyncTranscriptionLongStatusDTO:
    properties:
      expires_at:
        type: string
      expires_in_seconds:
        type: integer
      result:
        $ref: '#/definitions/dtos.AsyncTranscriptionLongResultDTO'
      status:
        example: completed
        type: string
    type: object
  dtos.AsyncTranscriptionProcessResponseDTO:
    properties:
      status:
        $ref: '#/definitions/dtos.AsyncTranscriptionStatusDTO'
      task_id:
        type: string
    type: object
  dtos.AsyncTranscriptionResultDTO:
    properties:
      text:
        example: Halo dunia
        type: string
      translated_text:
        example: Hello world
        type: string
    type: object
  dtos.AsyncTranscriptionStatusDTO:
    properties:
      expires_at:
        type: string
      expires_in_seconds:
        type: integer
      result:
        $ref: '#/definitions/dtos.AsyncTranscriptionResultDTO'
      status:
        example: completed
        type: string
    type: object
  dtos.MqttPublishRequest:
    properties:
      message:
        type: string
    required:
    - message
    type: object
  dtos.OutsystemsTranscriptionResultDTO:
    properties:
      detected_language:
        example: id
        type: string
      filename:
        example: audio.mp3
        type: string
      transcription:
        example: Halo dunia
        type: string
    type: object
  dtos.RAGProcessResponseDTO:
    properties:
      status:
        $ref: '#/definitions/dtos.RAGStatusDTO'
      task_id:
        type: string
    type: object
  dtos.RAGRequestDTO:
    properties:
      text:
        type: string
    type: object
  dtos.RAGStatusDTO:
    properties:
      body: {}
      endpoint:
        type: string
      execution_result:
        description: holds the response from the fetched endpoint
      expires_at:
        type: string
      expires_in_seconds:
        type: integer
      headers:
        additionalProperties:
          type: string
        type: object
      method:
        type: string
      result:
        description: raw LLM response when not structured
        type: string
      status:
        type: string
    type: object
  dtos.SensorDataDTO:
    properties:
      battery_percentage:
        type: integer
      humidity:
        type: integer
      status_text:
        type: string
      temp_unit:
        type: string
      temperature:
        type: number
    type: object
  dtos.TuyaAuthResponseDTO:
    properties:
      access_token:
        type: string
      expire_time:
        type: integer
      refresh_token:
        type: string
      uid:
        type: string
    type: object
  dtos.TuyaCommandDTO:
    properties:
      code:
        type: string
      value: {}
    required:
    - code
    - value
    type: object
  dtos.TuyaDeviceDTO:
    properties:
      category:
        type: string
      collections:
        items:
          $ref: '#/definitions/dtos.TuyaDeviceDTO'
        type: array
      create_time:
        type: integer
      custom_name:
        type: string
      gateway_id:
        type: string
      icon:
        type: string
      id:
        type: string
      ip:
        type: string
      local_key:
        type: string
      model:
        type: string
      name:
        type: string
      online:
        type: boolean
      product_name:
        type: string
      remote_category:
        type: string
      remote_id:
        type: string
      remote_product_name:
        type: string
      status:
        items:
          $ref: '#/definitions/dtos.TuyaDeviceStatusDTO'
        type: array
      update_time:
        type: integer
    type: object
  dtos.TuyaDeviceResponseDTO:
    properties:
      device:
        $ref: '#/definitions/dtos.TuyaDeviceDTO'
    type: object
  dtos.TuyaDeviceStatusDTO:
    properties:
      code:
        type: string
      value: {}
    type: object
  dtos.TuyaDevicesResponseDTO:
    properties:
      current_page_count:
        type: integer
      devices:
        items:
          $ref: '#/definitions/dtos.TuyaDeviceDTO'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_devices:
        type: integer
    type: object
  dtos.TuyaIRACCommandDTO:
    properties:
      code:
        type: string
      remote_id:
        type: string
      value:
        type: integer
    required:
    - code
    - remote_id
    type: object
  dtos.TuyaSyncDeviceDTO:
    properties:
      create_time:
        type: integer
      id:
        type: string
      online:
        type: boolean
      remote_id:
        type: string
      update_time:
        type: integer
    type: object
  dtos.WhisperProxyProcessResponseDTO:
    properties:
      status:
        $ref: '#/definitions/dtos.WhisperProxyStatusDTO'
      task_id:
        type: string
    type: object
  dtos.WhisperProxyStatusDTO:
    properties:
      expires_at:
        type: string
      expires_in_seconds:
        type: integer
      result:
        $ref: '#/definitions/dtos.OutsystemsTranscriptionResultDTO'
      status:
        example: completed
        type: string
    type: object
  teralux_app_domain_common_dtos.StandardResponse:
    properties:
      data: {}
      details: {}
      message:
        type: string
      status:
        type: boolean
    type: object
  teralux_app_domain_rag_dtos.StandardResponse:
    properties:
      data: {}
      details:
        type: string
      message:
        type: string
      status:
        type: boolean
    type: object
  teralux_app_domain_speech_dtos.StandardResponse:
    properties:
      data: {}
      details:
        type: string
      message:
        type: string
      status:
        type: boolean
    type: object
info:
  contact:
    email: support@swagger.io
    name: API Support
    url: http://www.swagger.io/support
  description: This is the API server for Teralux App. <br> For full documentation,
    visit <a href="/docs">/docs</a>.
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: Teralux API
  version: "1.0"
paths:
  /api/cache/flush:
    delete:
      consumes:
      - application/json
      description: Remove all data from the cache storage
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Flush all cache
      tags:
      - 03. Flush
  /api/rag:
    post:
      consumes:
      - application/json
      description: Submit text for RAG processing
      parameters:
      - description: RAG request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dtos.RAGRequestDTO'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_rag_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.RAGProcessResponseDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_rag_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_rag_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Process text via RAG
      tags:
      - 05. RAG
  /api/rag/{task_id}:
    get:
      parameters:
      - description: Task ID
        in: path
        name: task_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_rag_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.RAGStatusDTO'
              type: object
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/teralux_app_domain_rag_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Get RAG task status
      tags:
      - 05. RAG
  /api/speech/mqtt/publish:
    post:
      consumes:
      - application/json
      description: Publish a message to the configured MQTT topic
      parameters:
      - description: Message to publish
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dtos.MqttPublishRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Publish message to MQTT
      tags:
      - 04. Speech
  /api/speech/transcribe:
    post:
      consumes:
      - multipart/form-data
      description: 'Start transcription of audio file. Attempts PPU (Outsystems) first,
        falls back to local Whisper if PPU fails. Asynchronous processing. Supports:
        .mp3, .wav, .m4a, .aac, .ogg, .flac.'
      parameters:
      - description: Audio file (.mp3, .wav, .m4a, .aac, .ogg, .flac)
        in: formData
        name: audio
        required: true
        type: file
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.AsyncTranscriptionProcessResponseDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "415":
          description: Unsupported Media Type
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Transcribe audio file (with PPU fallback)
      tags:
      - 04. Speech
  /api/speech/transcribe/{transcribe_id}:
    get:
      description: Get the status and result of any transcription task (Short, Long,
        or PPU).
      parameters:
      - description: Task ID
        in: path
        name: transcribe_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.AsyncTranscriptionProcessResponseDTO'
              type: object
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Get transcription status (Consolidated)
      tags:
      - 04. Speech
  /api/speech/transcribe/long:
    post:
      consumes:
      - multipart/form-data
      description: 'Start transcription of long audio file using Whisper. Asynchronous
        processing with background execution. No translation, no RAG. Supports: .mp3,
        .wav, .m4a, .aac, .ogg, .flac.'
      parameters:
      - description: Audio file (.mp3, .wav, .m4a, .aac, .ogg, .flac)
        in: formData
        name: audio
        required: true
        type: file
      - description: Language code (e.g. id, en)
        in: formData
        name: language
        required: true
        type: string
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.AsyncTranscriptionLongProcessResponseDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "415":
          description: Unsupported Media Type
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Transcribe long audio file
      tags:
      - 04. Speech
  /api/speech/transcribe/ppu:
    post:
      consumes:
      - multipart/form-data
      description: Submit audio file for transcription via Outsystems proxy. Processing
        is asynchronous.
      parameters:
      - description: Audio file (.mp3, .wav, .m4a, .aac, .ogg, .flac)
        in: formData
        name: audio
        required: true
        type: file
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.WhisperProxyProcessResponseDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "415":
          description: Unsupported Media Type
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_speech_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Transcribe audio file (Proxy to Outsystems)
      tags:
      - 04. Speech
  /api/tuya/auth:
    get:
      consumes:
      - application/json
      description: Authenticates the user and retrieves a Tuya access token
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.TuyaAuthResponseDTO'
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - ApiKeyAuth: []
      summary: Authenticate with Tuya
      tags:
      - 01. Auth
  /api/tuya/devices:
    get:
      consumes:
      - application/json
      description: Retrieves a list of all devices in a Merged View (Smart IR remotes
        merged with Hubs). Sorted alphabetically by Name. For infrared_ac devices,
        the status array is populated with saved device state (power, temp, mode,
        wind) or default values if no state exists.
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: limit
        type: integer
      - description: Items per page (alias for limit)
        in: query
        name: per_page
        type: integer
      - description: Filter by category
        in: query
        name: category
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.TuyaDevicesResponseDTO'
              type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Get All Devices
      tags:
      - 02. Tuya
  /api/tuya/devices/{id}:
    get:
      consumes:
      - application/json
      description: Retrieves details of a specific device by its ID
      parameters:
      - description: Device ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.TuyaDeviceResponseDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Get Device by ID
      tags:
      - 02. Tuya
  /api/tuya/devices/{id}/commands/ir:
    post:
      consumes:
      - application/json
      description: Sends an infrared command to an AC via a specific IR device
      parameters:
      - description: Infrared Device ID
        in: path
        name: id
        required: true
        type: string
      - description: IR AC Command Payload
        in: body
        name: command
        required: true
        schema:
          $ref: '#/definitions/dtos.TuyaIRACCommandDTO'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Send IR AC Command
      tags:
      - 02. Tuya
  /api/tuya/devices/{id}/commands/switch:
    post:
      consumes:
      - application/json
      description: Sends a command to a specific Tuya device
      parameters:
      - description: Device ID
        in: path
        name: id
        required: true
        type: string
      - description: Command Payload
        in: body
        name: command
        required: true
        schema:
          $ref: '#/definitions/dtos.TuyaCommandDTO'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Send Command to Device
      tags:
      - 02. Tuya
  /api/tuya/devices/{id}/sensor:
    get:
      consumes:
      - application/json
      description: Retrieves sensor data (temperature, humidity, etc.) for a specific
        device
      parameters:
      - description: Device ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
            - properties:
                data:
                  $ref: '#/definitions/dtos.SensorDataDTO'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - BearerAuth: []
      summary: Get Sensor Data
      tags:
      - 02. Tuya
  /api/tuya/devices/sync:
    get:
      consumes:
      - application/json
      description: Fetches real-time status from Tuya. Does NOT update local DB. Returns
        fresh device list.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/dtos.TuyaSyncDeviceDTO'
                  type: array
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/teralux_app_domain_common_dtos.StandardResponse'
      security:
      - ApiKeyAuth: []
      - BearerAuth: []
      summary: Sync Teralux Device Status
      tags:
      - 02. Tuya
  /health:
    get:
      description: Check if the application and database are healthy
      produces:
      - text/plain
      responses:
        "200":
          description: OK
          schema:
            type: string
        "503":
          description: Service Unavailable
          schema:
            type: string
      summary: Health check endpoint
      tags:
      - 06. Health
schemes:
- http
- https
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: X-API-KEY
    type: apiKey
  BearerAuth:
    description: Type "Bearer" followed by a space and JWT token.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
tags:
- description: Authentication endpoints
  name: 01. Auth
- description: Tuya related endpoints
  name: 02. Tuya
- description: Cache management endpoints
  name: 03. Flush
- description: Speech endpoints
  name: 04. Speech
- description: RAG endpoints
  name: 05. RAG
- description: Health check endpoint
  name: 06. Health

